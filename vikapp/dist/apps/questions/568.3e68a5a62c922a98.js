/*! For license information please see 568.3e68a5a62c922a98.js.LICENSE.txt */
(self.webpackChunkquestions=self.webpackChunkquestions||[]).push([[568],{568:(e,t,n)=>{n.d(t,{c:()=>Y});var s=n(640),o=n(184),a=n(28);const i=a.K.injectEndpoints({endpoints:e=>({getQuestionById:e.query({query:e=>({url:`question/findById/${e}`})}),getQuestionByChat:e.query({query:e=>({url:`question/findByChatId/${e}`})}),updateQuestion:e.mutation({query:({id:e,question:t})=>({url:`/question/${e}`,method:"PATCH",body:{question:t}})}),addQuestion:e.mutation({query:e=>({url:"/question",method:"POST",body:e})}),deleteQuestion:e.mutation({query:e=>({url:"/chat-category",method:"DELETE",body:{id:e}})}),countAvailableQuestion:e.query({query:e=>({url:`auto-post/countAvailableQuestionByChatId/${e}`}),providesTags:["CountAvailableQuestionGroup"]}),countPublishedQuestion:e.query({query:e=>({url:`auto-post/countPublishedQuestion/${e}`}),providesTags:["CountAvailableQuestionGroup"]})})}),{useGetQuestionByChatQuery:r,useGetQuestionByIdQuery:l,useAddQuestionMutation:u,useDeleteQuestionMutation:c,useUpdateQuestionMutation:d,useCountAvailableQuestionQuery:g,useCountPublishedQuestionQuery:p}=i;var h=n(872),x=n(0);const m=({chat:e})=>{window.Telegram.WebApp;const{isLoading:t,data:n,isSuccess:s}=r(e);return(0,x.jsxs)(x.Fragment,{children:[t&&(0,x.jsx)(o.Preloader,{}),s&&n.map((e=>(0,x.jsx)("li",{className:"cursor-pointer",children:(0,x.jsx)(o.SimpleAccordionMain,{description:(0,x.jsxs)(o.SimpleAccordionText,{children:[(0,x.jsxs)("span",{className:"text-xs text-[var(--tg-theme-hint-color)]",children:["Дата: ",String(e.dateadd)]}),(0,x.jsx)("p",{className:"line-clamp-3",children:e.text}),(0,x.jsxs)("span",{className:"text-xs text-[var(--tg-theme-hint-color)]",children:["Категория: ",e.category]})]}),content:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(o.ButtonIcon,{firstIcon:!0,text:"Модерировать",color:"[var(--tg-theme-accent-text-color)]",icon:"moderate",func:h._W}),(0,x.jsx)(o.ButtonIcon,{firstIcon:!0,text:"Статистика",color:"[var(--tg-theme-accent-text-color)]",icon:"stat",func:h._W}),(0,x.jsx)(o.ButtonIcon,{firstIcon:!0,text:"Отправить",color:"[var(--tg-theme-accent-text-color)]",icon:"send",func:h._W}),(0,x.jsx)(o.ButtonIconConfirm,{firstIcon:!0,text:"Удалить",color:"red-500",icon:"delete",func:h._g,textConfirm:`Вы действительно хотите удалить вопрос №${s?n[0].id:"не success"}`})]})})})))]})},v=()=>(0,x.jsx)("ul",{role:"list",className:"divide-y divide-[var(--tg-theme-hint-color)]",children:(0,x.jsx)(m,{chat:521884639})});var y=n(796);const w=(0,y.createSlice)({name:"questionApp",initialState:{questionSlide:!1,questionType:"",questionData:void 0,addQuestion:{text:"",category:0,answer1:"",answer2:"",answer3:"",answer4:"",answerright:0}},reducers:{showQuestionSlide:(e,t)=>{e.questionSlide=t.payload},typeQuestion:(e,t)=>{e.questionType=t.payload},dataQuestion:(e,t)=>{e.questionData=t.payload},getQuestionText:(e,t)=>{e.addQuestion.text=t.payload},getQuestionCategory:(e,t)=>{e.addQuestion.category=t.payload},getQuestionAnswerOne:(e,t)=>{e.addQuestion.answer1=t.payload},getQuestionAnswerTwo:(e,t)=>{e.addQuestion.answer2=t.payload},getQuestionAnswerThree:(e,t)=>{e.addQuestion.answer3=t.payload},getQuestionAnswerFour:(e,t)=>{e.addQuestion.answer4=t.payload},getQuestionAnswerright:(e,t)=>{e.addQuestion.answerright=t.payload},getQuestionDefault:(e,t)=>{e.addQuestion.text="",e.addQuestion.category=0,e.addQuestion.answer1="",e.addQuestion.answer2="",e.addQuestion.answer3="",e.addQuestion.answer4="",e.addQuestion.answerright=0}}}),{showQuestionSlide:f,typeQuestion:j,dataQuestion:Q,getQuestionText:b,getQuestionCategory:A,getQuestionAnswerOne:S,getQuestionAnswerTwo:q,getQuestionAnswerThree:T,getQuestionAnswerFour:B,getQuestionAnswerright:C,getQuestionDefault:M}=w.actions,k=e=>e.questionApp.questionSlide,N=e=>e.questionApp.questionType,_=e=>e.questionApp.addQuestion.text,I=e=>e.questionApp.addQuestion.category,P=e=>e.questionApp.addQuestion,F=w.reducer,E=(0,y.configureStore)({reducer:{[a.K.reducerPath]:a.K.reducer,questionApp:F},middleware:e=>e().concat(a.K.middleware)}),O=()=>(0,s.useDispatch)(),L=s.useSelector;var W=n(136);function G({onSubmit:e}){const t=window.Telegram.WebApp,n=L(_),s=O(),[a,i]=(0,W.useState)("");(0,W.useEffect)((()=>{const e=e=>e?r(n):s(M(""));setTimeout((()=>{""!=n&&t.showConfirm("Применить несохранённый черновик?",e)}),1500)}),[]);const r=e=>{i(e),s(b(e))};return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:"py-2",children:[(0,x.jsx)(o.SimpleTextArea,{label:"Текст вопроса:",rows:5,value:a,func:e=>r(e.target.value)}),(0,x.jsx)("div",{className:"py-4",children:(0,x.jsx)(o.ValidateLengthForm,{text:"Длина текста ответов должна быть не менее 10 не более 25 символов",data:{value:a,lengthMin:10,lengthMax:25},validation:n=>{n?(t.MainButton.setText("Следующий шаг"),t.MainButton.show(),t.onEvent("mainButtonClicked",e)):t.MainButton.hide()}})})]})})}function D({step:e,stepsCount:t}){let n=[];for(let s=0;s<t;s++)n.push({id:s,status:e>s?"complete":"upcoming"});return(0,x.jsxs)("nav",{className:"flex items-center px-8 pt-8 pb-4 bg-[var(--tg-theme-bg-color)] space-x-3 justify-center","aria-label":"Progress",children:[(0,x.jsxs)("p",{className:"text-sm font-medium text-[var(--tg-theme-accent-text-color)]",children:["Шаг ",e," из ",t]}),(0,x.jsx)("ol",{role:"list",className:"ml-8 flex items-center space-x-5",children:n.map((e=>(0,x.jsx)("li",{children:"complete"===e.status?(0,x.jsx)("span",{className:"block h-2.5 w-2.5 rounded-full bg-[var(--tg-theme-accent-text-color)]"}):"current"===e.status?(0,x.jsxs)("span",{className:"relative flex items-center justify-center","aria-current":"step",children:[(0,x.jsx)("span",{className:"absolute flex h-5 w-5 p-px","aria-hidden":"true",children:(0,x.jsx)("span",{className:"h-full w-full rounded-full bg-[var(--tg-theme-text-color)]"})}),(0,x.jsx)("span",{className:"relative block h-2.5 w-2.5 rounded-full bg-[var(--tg-theme-accent-text-color)]","aria-hidden":"true"})]}):(0,x.jsx)("span",{className:"block h-2.5 w-2.5 rounded-full bg-[var(--tg-theme-text-color)]"})},e.id)))})]})}var $=n(424);const K=window.Telegram.WebApp;function R({onSubmit:e}){const t=L(I),{data:n,isSuccess:s}=(0,$.useGetCategoryQuery)(""),a=O(),[i,r]=(0,W.useState)(0!=t&&"object"==typeof n?n.find((e=>e.id===t)):{id:0,name:""});return(0,x.jsxs)("div",{className:"py-2",children:[s&&(0,x.jsx)(o.SimpleCategorySelect,{value:i||{id:0,name:" "},func:e=>{r(e),a(A(e.id))},data:n}),(0,x.jsx)("div",{className:"py-4",children:(0,x.jsx)(o.ValidateLengthForm,{text:"Выберите подходящую категорию",data:{value:i?i.id:0,lengthMin:0,lengthMax:0},validation:t=>{t?(K.MainButton.setText("Следующий шаг"),K.MainButton.show(),K.onEvent("mainButtonClicked",e)):K.MainButton.hide()}})})]})}function V({onSubmit:e}){const t=window.Telegram.WebApp,n=L(P),[s,a]=(0,W.useState)(n.answerright),[i,r]=(0,W.useState)([{id:1,name:"Answer1",value:""},{id:2,name:"Answer2",value:""},{id:3,name:"Answer3",value:""},{id:4,name:"Answer4",value:""}]),l=O(),u=e=>{const t=e.target.name,n=e.target.value,s=i.map((e=>e.name===t?Object.assign({},e,{value:n}):e));r(s)},c=n=>{n?(t.MainButton.setText("Следующий шаг"),t.MainButton.show(),t.onEvent("mainButtonClicked",(t.MainButton.hide(),e))):t.MainButton.hide()},d=e=>{a(e),l(C(e))};return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:"py-2",children:[i.map((e=>(0,x.jsx)(o.SimpleInputAnswer,{id:e.id,selected:s,value:e.value,funcChange:u,funcButton:d}))),(0,x.jsxs)("div",{className:"py-4",children:[(0,x.jsx)(o.ValidateLengthForm,{text:"Длина текста ответов должна быть не менее 10 не более 25 символов",data:{value:i,lengthMin:10,lengthMax:25},validation:c}),(0,x.jsx)(o.ValidateLengthForm,{text:"Обязательно нужно выбрать верный вариант ответа (вопросы для всех групп проходят модерацию)",data:{value:s,lengthMin:0,lengthMax:0},validation:c})]})]})})}const U=()=>{const e=window.Telegram.WebApp,t=O(),n=L(P),{steps:s,currentStepIndex:a,step:i,isLastStep:r,next:l}=function(e){const[t,n]=(0,W.useState)(0);return{currentStepIndex:t,step:e[t],steps:e,isFirstStep:0===t,isLastStep:t===e.length-1,goTo:function(e){n(e)},next:function(){n((t=>t>=e.length-1?t:t+1))},back:function(){n((e=>e<=0?e:e-1))}}}([(0,x.jsx)(G,{onSubmit:d}),(0,x.jsx)(R,{onSubmit:d}),(0,x.jsx)(V,{onSubmit:d})]),[c,{}]=u();async function d(){if(e.MainButton.hide(),!r)return l();r&&(await c({chat:521884639,text:n.text,category:n.category,answer1:n.answer1,answer2:n.answer2,answer3:n.answer3,answer4:n.answer4,answerright:n.answerright}),t(f(!1)),t(M("")))}return(0,x.jsxs)(o.Page,{children:[(0,x.jsx)(o.HeaderBlock,{children:(0,x.jsx)(D,{step:a+1,stepsCount:s.length})}),(0,x.jsx)(o.MainBlock,{children:i})]})},H=()=>{const e=window.Telegram.WebApp,t=O(),n=L(k),s=L(N);return n&&(e.BackButton.show(),e.onEvent("backButtonClicked",(()=>{t(f(!1))}))),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(o.GlobalHeader,{children:(0,x.jsx)(o.ButtonIcon,{firstIcon:!0,text:"Добавить вопрос",color:"[var(--tg-theme-accent-text-color)]",icon:"add",func:()=>{t(j("addQuestion")),t(f(!0))}})}),(0,x.jsx)(o.Page,{children:(0,x.jsxs)(o.MainBlock,{children:[(0,x.jsx)("div",{className:"text-center pt-9"}),(0,x.jsx)(v,{})]})}),(0,x.jsx)(o.SlidePage,{slide:n,children:"addQuestion"==s&&(0,x.jsx)(U,{})})]})},Y=()=>(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(s.Provider,{store:E,children:(0,x.jsx)(H,{})})})},28:(e,t,n)=>{n.d(t,{K:()=>i});var s=n(392),o=n(280);const a=(0,s.c9)((0,s._)({baseUrl:"https://api80q.ru/viktorinaonlinebot/"}),{maxRetries:5}),i=(0,o.KS)({reducerPath:"vikApi",refetchOnFocus:!0,baseQuery:a,tagTypes:["TypeGroup","TimeGroup","CategoryGroup","Validate","CountAvailableQuestionGroup","CountPublishedQuestionGroup"],endpoints:()=>({})})},872:(e,t,n)=>{n.d(t,{_g:()=>a,_W:()=>o,IF:()=>i});const s=window.Telegram.WebApp,o=()=>{s.showAlert("Данная функция находится в разработке",console.log("inDevelopment"))},a=e=>{if(e)return s.openTelegramLink("https://t.me/more_details")},i=e=>"string"==typeof e.value?(console.log("string"),e.value.length<e.lengthMin||e.value.length>e.lengthMax?(console.log("string length = ",e.value.length),console.log("false"),!1):(console.log("string length = ",e.value.length),console.log("number = ",e.value),console.log("true"),!0)):"number"==typeof e.value?(console.log("number"),0===e.value?(console.log("number = ",e.value),console.log("false"),!1):(console.log("number = ",e.value),console.log("true"),!0)):("object"==typeof e.value&&(console.log("object"),e.value.map((t=>t.value.length<e.lengthMin||t.value.length>e.lengthMax?(console.log("object length = ",t.value.length),console.log("false"),!1):(console.log("object length = ",t.value.length),console.log("true"),!0)))),!1)},488:(e,t,n)=>{var s=n(136),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var s,a={},u=null,c=null;for(s in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)i.call(t,s)&&!l.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===a[s]&&(a[s]=t[s]);return{$$typeof:o,type:e,key:u,ref:c,props:a,_owner:r.current}}t.Fragment=a,t.jsx=u,t.jsxs=u},0:(e,t,n)=>{e.exports=n(488)}}]);