(self.webpackChunkchat_room=self.webpackChunkchat_room||[]).push([[151],{151:(e,t,o)=>{o.r(t);var a=o(179),s=o(873),c=o(215),n=o(420),i=o(885);const r=(0,n.L5)((0,n.cw)({baseUrl:"https://api80q.ru/mdws/chats"})),l=(0,i.xP)({reducerPath:"mdwsApi",refetchOnFocus:!0,baseQuery:r,tagTypes:["Validate"],endpoints:()=>({})}),d=l.injectEndpoints({endpoints:e=>({validate:e.query({query:e=>({url:`chat/validateUser/${e}`}),providesTags:["Validate"]}),join:e.mutation({query:({chat:e,user:t})=>({url:"/join",method:"POST",body:{chat:e,user:t}})})})}),{useValidateQuery:h,useJoinMutation:m}=d;var p=o(343),u=o(48),x=o(490),g=o(85);const R=({accessToken:e})=>{console.log("accessToken",e);const[t,o]=(0,a.useState)([]);return(0,a.useEffect)((()=>{const a=(0,x.io)("https://api80q.ru/chat",{auth:{token:e},transports:["websocket","polling"]}),s=e=>{o((t=>[...t,e])),console.log("args ",e),console.log("state ",t)};a.on("chat_updated",s),a.on("exception",s),a.on("message",s)}),[e]),console.log("state ",t),(0,g.jsx)("p",{children:(0,g.jsxs)(p.A,{children:[t&&t.map((e=>(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(u.A,{name:String(e.user),text:e.text,time:String(e.chat)},e.id)}))),(0,g.jsx)("b",{children:"1"})]})})};var j=o(647),y=o(638);const C=(0,y.createSlice)({name:"chatRoomApp",initialState:{chatRoomSlide:!1,chatRoomType:"",chatRoomChat:{isLoading:!1,wsErrors:[],isAdmin:!1,nominationCount:0,participantCount:0},chatRoomData:void 0},reducers:{setChatAccessToken:(e,t)=>{e.chatRoomChat.accessToken=t.payload},initializePoll:(e,t)=>{e.chatRoomChat.poll=t.payload},loadingChat:(e,t)=>{e.chatRoomChat.isLoading=t.payload},showChatRoomSlide:(e,t)=>{e.chatRoomSlide=t.payload},typeChatRoom:(e,t)=>{e.chatRoomType=t.payload},dataChatRoom:(e,t)=>{e.chatRoomData=t.payload}}}),{showChatRoomSlide:v,typeChatRoom:k,dataChatRoom:w,initializePoll:S,loadingChat:f,setChatAccessToken:T}=C.actions,A=e=>e.chatRoomApp.chatRoomSlide,b=e=>e.chatRoomApp.chatRoomType,N=C.reducer,P=(0,y.configureStore)({reducer:{[l.reducerPath]:l.reducer,chatRoomApp:N},middleware:e=>e().concat(l.middleware)}),B=c.useSelector,E=()=>{const e=(0,c.useDispatch)(),t=B(A),o=B(b),[s,{data:n}]=m();return((e,t)=>{const o=window.Telegram.WebApp;(0,a.useEffect)((()=>{e?(o.BackButton.show(),o.onEvent("backButtonClicked",(o.MainButton.hide(),t))):o.BackButton.hide()}),[e])})(t,(()=>e(v(!1)))),console.log(t),console.log(o),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("ul",{role:"list",className:"text-left divide-y divide-[var(--tg-theme-hint-color)]",children:(0,g.jsx)(j.Contact,{handelClick:()=>{e(k("openChatRoom")),e(v(!0)),s({chat:10,user:3})},img:"",name:"Антонио-Молодец",time:"17.03.24",lastMessage:"...."})}),(0,g.jsx)(j.SlidePage,{slide:t,children:"openChatRoom"==o&&(0,g.jsx)(R,{accessToken:null==n?void 0:n.accessToken})})]})},q=()=>(0,g.jsx)(c.Provider,{store:P,children:(0,g.jsx)(E,{})});s.H(document.getElementById("root")).render((0,g.jsx)(a.StrictMode,{children:(0,g.jsx)(q,{})}))},343:(e,t,o)=>{o.d(t,{A:()=>c,X:()=>s});var a=o(85);function s({children:e}){return(0,a.jsx)("div",{className:"flex-1 overflow-auto bg-orange-200",children:(0,a.jsx)("div",{className:"py-2 px-3",children:e})})}const c=s},48:(e,t,o)=>{o.d(t,{A:()=>c,e:()=>s});var a=o(85);function s({name:e,text:t,time:o}){return(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"flex mb-2",children:(0,a.jsxs)("div",{className:"rounded py-2 px-3 bg-slate-300",children:[(0,a.jsxs)("p",{className:"text-sm text-orange",children:["Имя: ",e]}),(0,a.jsx)("p",{className:"text-sm mt-1",children:t}),(0,a.jsx)("p",{className:"text-right text-xs text-grey-dark mt-1",children:o})]})})})}const c=s},873:(e,t,o)=>{var a=o(67);t.H=a.createRoot,a.hydrateRoot}}]);