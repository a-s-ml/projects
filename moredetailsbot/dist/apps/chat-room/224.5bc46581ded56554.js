(self.webpackChunkchat_room=self.webpackChunkchat_room||[]).push([[224],{224:(e,a,o)=>{o.r(a),o.d(a,{default:()=>S});var t=o(215),s=o(420),c=o(885);const n=(0,s.L5)((0,s.cw)({baseUrl:"https://api80q.ru/mdws/chats"})),i=(0,c.xP)({reducerPath:"mdwsApi",refetchOnFocus:!0,baseQuery:n,tagTypes:["Validate"],endpoints:()=>({})}),r=i.injectEndpoints({endpoints:e=>({validate:e.query({query:e=>({url:`chat/validateUser/${e}`}),providesTags:["Validate"]}),join:e.mutation({query:({chat:e,user:a})=>({url:"/join",method:"POST",body:{chat:e,user:a}})})})}),{useValidateQuery:l,useJoinMutation:d}=r;var h=o(85);const p=function({children:e}){return(0,h.jsx)("div",{className:"flex-1 overflow-auto bg-orange-200",children:(0,h.jsx)("div",{className:"py-2 px-3",children:e})})};var u=o(179),m=o(490);const x=({accessToken:e})=>{console.log("accessToken",e);const[a,o]=(0,u.useState)([]);return(0,u.useEffect)((()=>{const a=(0,m.io)("https://api80q.ru/chat",{auth:{token:e},transports:["websocket","polling"]}),o=(...e)=>{console.log(e)};a.on("chat_updated",o),a.on("exception",o),a.on("message",o)}),[e]),(0,h.jsx)("p",{children:(0,h.jsxs)(p,{children:[(0,h.jsx)("p",{children:"1"}),(0,h.jsx)("p",{children:"2"}),(0,h.jsx)("p",{children:"3"}),(0,h.jsx)("p",{children:"4"}),a.map((e=>(0,h.jsx)("p",{children:e})))]})})},C=()=>{const[e,{data:a}]=d();return(0,h.jsxs)("div",{className:"text-center p-10",children:[(0,h.jsx)("button",{className:"p-2 text-red-300 bg-slate-100",onClick:()=>(e({chat:10,user:3}),void console.log(a)),children:"Click"}),(0,h.jsx)(x,{accessToken:null==a?void 0:a.accessToken})]})};var y=o(638);const R=(0,y.createSlice)({name:"chatRoomApp",initialState:{chatRoomSlide:!1,chatRoomType:"",chatRoomChat:{isLoading:!1,wsErrors:[],isAdmin:!1,nominationCount:0,participantCount:0},chatRoomData:void 0},reducers:{setChatAccessToken:(e,a)=>{e.chatRoomChat.accessToken=a.payload},initializePoll:(e,a)=>{e.chatRoomChat.poll=a.payload},loadingChat:(e,a)=>{e.chatRoomChat.isLoading=a.payload},showChatRoomSlide:(e,a)=>{e.chatRoomSlide=a.payload},typeChatRoom:(e,a)=>{e.chatRoomType=a.payload},dataChatRoom:(e,a)=>{e.chatRoomData=a.payload}}}),{showChatRoomSlide:j,typeChatRoom:g,dataChatRoom:k,initializePoll:v,loadingChat:w,setChatAccessToken:T}=R.actions,f=R.reducer,b=(0,y.configureStore)({reducer:{[i.reducerPath]:i.reducer,chatRoomApp:f},middleware:e=>e().concat(i.middleware)}),S=()=>(0,h.jsx)(t.Provider,{store:b,children:(0,h.jsx)(C,{})})}}]);