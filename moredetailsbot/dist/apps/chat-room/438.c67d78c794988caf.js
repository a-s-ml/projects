(self.webpackChunkchat_room=self.webpackChunkchat_room||[]).push([[438],{57:(e,t,a)=>{a.r(t);var o=a(179),s=a(873),c=a(215),n=a(420),r=a(885);const i=(0,n.L5)((0,n.cw)({baseUrl:"https://api80q.ru/mdws/chats"})),d=(0,r.xP)({reducerPath:"mdwsApi",refetchOnFocus:!0,baseQuery:i,tagTypes:["Validate"],endpoints:()=>({})}),l=d.injectEndpoints({endpoints:e=>({validate:e.query({query:e=>({url:`chat/validateUser/${e}`}),providesTags:["Validate"]}),join:e.mutation({query:({chat:e,user:t})=>({url:"/join",method:"POST",body:{chat:e,user:t}})})})}),{useValidateQuery:h,useJoinMutation:m}=l;var u=a(85);const p=function({children:e}){return(0,u.jsx)("div",{className:"flex-1 overflow-auto bg-orange-200",children:(0,u.jsx)("div",{className:"py-2 px-3",children:e})})},x=function({name:e,text:t,time:a}){return(0,u.jsx)("div",{children:(0,u.jsx)("div",{className:"flex mb-2",children:(0,u.jsxs)("div",{className:"rounded py-2 px-3 bg-slate-300",children:[(0,u.jsx)("p",{className:"text-sm text-orange",children:e}),(0,u.jsx)("p",{className:"text-sm mt-1",children:t}),(0,u.jsx)("p",{className:"text-right text-xs text-grey-dark mt-1",children:a})]})})})};var g=a(490);const j=({accessToken:e})=>{console.log("accessToken",e);const[t,a]=(0,o.useState)([{id:0,user:0,chat:0,text:""}]);return(0,o.useEffect)((()=>{const t=(0,g.io)("https://api80q.ru/chat",{auth:{token:e},transports:["websocket","polling"]}),o=(...e)=>{a((t=>Object.assign({},t,{args:e}))),console.log("args ",e)};t.on("chat_updated",o),t.on("exception",o),t.on("message",o)}),[e]),console.log("state ",t),(0,u.jsx)("p",{children:(0,u.jsxs)(p,{children:[t&&t.map((e=>(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(x,{name:String(e.user),text:e.text,time:String(e.chat)},e.id)}))),(0,u.jsx)("b",{children:"1"})]})})},y=()=>{const[e,{data:t}]=m();return(0,u.jsxs)("div",{className:"text-center p-10",children:[(0,u.jsx)("button",{className:"p-2 text-red-300 bg-slate-100",onClick:()=>(e({chat:10,user:3}),void console.log(t)),children:"Click"}),(0,u.jsx)(j,{accessToken:null==t?void 0:t.accessToken})]})};var C=a(638);const R=(0,C.createSlice)({name:"chatRoomApp",initialState:{chatRoomSlide:!1,chatRoomType:"",chatRoomChat:{isLoading:!1,wsErrors:[],isAdmin:!1,nominationCount:0,participantCount:0},chatRoomData:void 0},reducers:{setChatAccessToken:(e,t)=>{e.chatRoomChat.accessToken=t.payload},initializePoll:(e,t)=>{e.chatRoomChat.poll=t.payload},loadingChat:(e,t)=>{e.chatRoomChat.isLoading=t.payload},showChatRoomSlide:(e,t)=>{e.chatRoomSlide=t.payload},typeChatRoom:(e,t)=>{e.chatRoomType=t.payload},dataChatRoom:(e,t)=>{e.chatRoomData=t.payload}}}),{showChatRoomSlide:v,typeChatRoom:k,dataChatRoom:b,initializePoll:w,loadingChat:S,setChatAccessToken:T}=R.actions,f=R.reducer,N=(0,C.configureStore)({reducer:{[d.reducerPath]:d.reducer,chatRoomApp:f},middleware:e=>e().concat(d.middleware)}),P=()=>(0,u.jsx)(c.Provider,{store:N,children:(0,u.jsx)(y,{})});s.H(document.getElementById("root")).render((0,u.jsx)(o.StrictMode,{children:(0,u.jsx)(P,{})}))},873:(e,t,a)=>{var o=a(67);t.H=o.createRoot,o.hydrateRoot}}]);